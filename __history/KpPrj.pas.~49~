unit KpPrj;

interface

uses
  ShellApi, Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.Menus, Vcl.ComCtrls,
  Vcl.Imaging.pngimage, Vcl.ExtCtrls, Vcl.StdCtrls, Vcl.ToolWin, AdvPageControl,
  AdvOfficePager, AdvOfficePagerStylers, Data.DB, Vcl.Grids, Vcl.DBGrids,
  System.ImageList, Vcl.ImgList;

type
  TMainFrm = class(TForm)
    MainMenu1: TMainMenu;
    File1: TMenuItem;
    Signatories1: TMenuItem;
    SystemPatch1: TMenuItem;
    Backup1: TMenuItem;
    UsersCredentials1: TMenuItem;
    About1: TMenuItem;
    StatusBar1: TStatusBar;
    N3: TMenuItem;
    Exit1: TMenuItem;
    PopupMenu1: TPopupMenu;
    Refresh1: TMenuItem;
    AboutUs1: TMenuItem;
    AdvPageControl1: TAdvPageControl;
    AdvTabSheet1: TAdvTabSheet;
    AdvTabSheet2: TAdvTabSheet;
    AdvTabSheet3: TAdvTabSheet;
    pnlLeft: TPanel;
    Image3: TImage;
    Image2: TImage;
    Image1: TImage;
    ToolBar1: TToolBar;
    Button1: TButton;
    btEdit1: TButton;
    btDele1: TButton;
    btFind1: TButton;
    ImageList1: TImageList;
    ToolBar2: TToolBar;
    Button4: TButton;
    btEdit2: TButton;
    btDele2: TButton;
    btFind2: TButton;
    ToolButton1: TToolButton;
    btF1: TButton;
    btF4: TButton;
    DBGrid2: TDBGrid;
    ImageList2: TImageList;
    Panel3: TPanel;
    DBGrid1: TDBGrid;
    Panel1: TPanel;
    Splitter1: TSplitter;
    AdvTabSheet4: TAdvTabSheet;
    ToolBar3: TToolBar;
    Button10: TButton;
    btEdit3: TButton;
    btDele3: TButton;
    btFind3: TButton;
    DBGrid3: TDBGrid;
    ImageList3: TImageList;
    imageFree: TImage;
    Label1: TLabel;
    Image5: TImage;
    GroupBox1: TGroupBox;
    GroupBox2: TGroupBox;
    GroupBox3: TGroupBox;
    Label2: TLabel;
    Label3: TLabel;
    Label4: TLabel;
    GroupBox4: TGroupBox;
    DBGrid4: TDBGrid;
    Label5: TLabel;
    btUQry: TButton;
    bpLogo: TImage;
    Label6: TLabel;
    Label7: TLabel;
    procedure About1Click(Sender: TObject);
    procedure Exit1Click(Sender: TObject);
    procedure FormShow(Sender: TObject);
    procedure Refresh1Click(Sender: TObject);
    procedure AboutUs1Click(Sender: TObject);
    procedure Button1Click(Sender: TObject);
    procedure Signatories1Click(Sender: TObject);
    procedure SystemPatch1Click(Sender: TObject);
    procedure UsersCredentials1Click(Sender: TObject);
    procedure Backup1Click(Sender: TObject);
    procedure AdvPageControl1Changing(Sender: TObject;
      var AllowChange: Boolean);
    procedure Button4Click(Sender: TObject);
    procedure Button10Click(Sender: TObject);

  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
 MainFrm: TMainFrm;

implementation

{$R *.dfm}

uses abtPas, splash, KPmasterlist, LuponMem, KPdataentry, Signatories, Settings,
  users, crimeType, msgPas;

procedure TMainFrm.About1Click(Sender: TObject);
begin
     abtFrm.ShowModal;
end;

procedure TMainFrm.AboutUs1Click(Sender: TObject);
begin
     AbtFrm.ShowModal;
end;

procedure TMainFrm.AdvPageControl1Changing(Sender: TObject;
  var AllowChange: Boolean);
begin
     AdvPageControl1.ActiveFont.Size := 12;
     AdvPageControl1.ActiveFont.Style :=[fsBold, fsUnderline, fsItalic];
     //AdvPageControl1.ActiveFont.Style :=[fsItalic];
end;

procedure TMainFrm.Backup1Click(Sender: TObject);
begin
     ShowMessage(' Backup Database... ');
end;

procedure TMainFrm.Button10Click(Sender: TObject);
begin
     frmCaseType.ShowModal;
end;

procedure TMainFrm.Button1Click(Sender: TObject);
begin
     KPdataentryFrm.showModal;
end;

procedure TMainFrm.Button4Click(Sender: TObject);
begin
     frmLuponMem.ShowModal;
end;

procedure TMainFrm.Exit1Click(Sender: TObject);
begin
     Close;
end;

procedure TMainFrm.FormShow(Sender: TObject);
begin
     Image1.Picture.LoadFromFile('./docs/bgForm.png');
     bpLogo.Picture.LoadFromFile('./docs/bpLogo.png');
     imageFree.Picture.LoadFromFile('./docs/freeware.png');
     AdvPageControl1.ActivePage := AdvTabSheet1;
     ClientHeight := 753;
     ClientWidth  := 1085;

     splashFrm.Tag := 0;

     SplashFrm.showModal;

     // if not logged in
     if splashFrm.Tag = 0 then
     begin
        Showmessage('not logged in');
       Application.Terminate;
     end;

     //Panel3.Alignment := taLeftJustify;
     //Panel1.Alignment := taLeftJustify;

     //Image1.Picture.LoadFromFile('C:\Path\To\Your\Image.jpg');
     //Form3.rtContact.lines.loadfromfile('./docs/bgForm.png');
end;

procedure TMainFrm.Refresh1Click(Sender: TObject);
begin
     //ShowMessage(' System Refresh ');
     frmMsg.ShowModal;
end;

procedure TMainFrm.Signatories1Click(Sender: TObject);
begin
     frmSignatories.ShowModal;
end;

procedure TMainFrm.SystemPatch1Click(Sender: TObject);
begin
    frmSettings.ShowModal;
end;

procedure TMainFrm.UsersCredentials1Click(Sender: TObject);
begin
     frmUsers.ShowModal;
end;

end.
